<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Dreams - Art Project</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            font-family: 'Courier New', monospace;
            background: #000;
        }

        .dream-selector {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 100;
        }

        .dream-btn {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            cursor: pointer;
            border-radius: 30px;
            font-family: 'Courier New', monospace;
            font-size: 15px;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .dream-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 255, 255, 0.2);
        }

        .dream-btn.active {
            background: rgba(255, 255, 255, 0.25);
            border-color: white;
            box-shadow: 0 10px 40px rgba(255, 255, 255, 0.4);
        }

        #audio-toggle {
            position: absolute;
            top: 30px;
            right: 30px;
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            cursor: pointer;
            border-radius: 25px;
            font-family: 'Courier New', monospace;
            z-index: 100;
            backdrop-filter: blur(20px);
            font-size: 14px;
        }

        #audio-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        #dream-title {
            position: absolute;
            top: 30px;
            left: 30px;
            color: white;
            font-size: 32px;
            z-index: 100;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            letter-spacing: 3px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="dream-title">FALLING</div>
    <button id="audio-toggle">ðŸ”Š Sound</button>

    <div class="dream-selector">
        <button class="dream-btn active" data-dream="0">Falling</button>
        <button class="dream-btn" data-dream="1">Kaleidoscope</button>
        <button class="dream-btn" data-dream="2">Vortex</button>
        <button class="dream-btn" data-dream="3">Fractal</button>
    </div>

    <script>
        // Audio Context
        let audioContext;
        let audioEnabled = false;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            audioEnabled = !audioEnabled;
            document.getElementById('audio-toggle').textContent = audioEnabled ? 'ðŸ”Š Sound' : 'ðŸ”‡ Mute';
        }

        function playSound(frequency, duration, type = 'sine', detune = 0) {
            if (!audioEnabled || !audioContext) return;

            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filter = audioContext.createBiquadFilter();

            oscillator.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.frequency.value = frequency;
            oscillator.detune.value = detune;
            oscillator.type = type;

            filter.type = 'lowpass';
            filter.frequency.value = 2000;

            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);

            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + duration);
        }

        document.getElementById('audio-toggle').addEventListener('click', initAudio);

        // P5.js Dreams
        let currentDream = 0;
        let transitionProgress = 0;
        let time = 0;

        // Dream 1: Falling - Objects fall downward
        let fallingObjects = [];
        
        class FallingObject {
            constructor() {
                this.x = random(width);
                this.y = -50;
                this.size = random(20, 80);
                this.speed = random(2, 6);
                this.rotation = random(TWO_PI);
                this.rotSpeed = random(-0.05, 0.05);
                this.type = floor(random(3));
                this.color = color(random(100, 255), random(100, 255), random(100, 255));
                this.alpha = 255;
            }

            update() {
                this.y += this.speed;
                this.rotation += this.rotSpeed;
                
                if (this.y > height + 100) {
                    this.y = -50;
                    this.x = random(width);
                }
            }

            display() {
                push();
                translate(this.x, this.y);
                rotate(this.rotation);
                fill(red(this.color), green(this.color), blue(this.color), this.alpha);
                noStroke();
                
                if (this.type === 0) {
                    rect(-this.size/2, -this.size/2, this.size, this.size);
                } else if (this.type === 1) {
                    triangle(0, -this.size/2, -this.size/2, this.size/2, this.size/2, this.size/2);
                } else {
                    ellipse(0, 0, this.size);
                }
                pop();
            }
        }

        // Dream 2: Kaleidoscope - Symmetrical patterns
        let kaleidoSegments = 12;
        
        // Dream 3: Vortex - Spiraling whirlpool
        let vortexParticles = [];
        
        class VortexParticle {
            constructor() {
                this.angle = random(TWO_PI);
                this.radius = 0;
                this.speed = random(1, 3);
                this.size = random(3, 10);
                this.hue = random(360);
            }

            update() {
                this.radius += this.speed;
                this.angle += 0.05;
                
                if (this.radius > width * 0.7) {
                    this.radius = 0;
                    this.angle = random(TWO_PI);
                    this.hue = random(360);
                }
            }

            display() {
                let x = width/2 + cos(this.angle) * this.radius;
                let y = height/2 + sin(this.angle) * this.radius;
                
                colorMode(HSB);
                fill(this.hue, 80, 100, map(this.radius, 0, width*0.7, 255, 0));
                noStroke();
                ellipse(x, y, this.size);
                colorMode(RGB);
            }
        }

        // Dream 4: Fractal - Recursive tree structure
        function drawFractalTree(x, y, len, angle, depth) {
            if (depth === 0) return;
            
            let x2 = x + cos(angle) * len;
            let y2 = y + sin(angle) * len;
            
            colorMode(HSB);
            stroke(map(depth, 0, 10, 200, 300) % 360, 70, 90, 200);
            strokeWeight(depth * 0.5);
            line(x, y, x2, y2);
            
            drawFractalTree(x2, y2, len * 0.67, angle - PI/6, depth - 1);
            drawFractalTree(x2, y2, len * 0.67, angle + PI/6, depth - 1);
            colorMode(RGB);
        }

        function setup() {
            createCanvas(windowWidth, windowHeight);
            
            // Initialize falling objects
            for (let i = 0; i < 30; i++) {
                let obj = new FallingObject();
                obj.y = random(height);
                fallingObjects.push(obj);
            }
            
            // Initialize vortex
            for (let i = 0; i < 150; i++) {
                vortexParticles.push(new VortexParticle());
            }
        }

        function draw() {
            time += 0.01;
            
            // Different dream rendering
            if (currentDream === 0) {
                drawFallingDream();
            } else if (currentDream === 1) {
                drawKaleidoscopeDream();
            } else if (currentDream === 2) {
                drawVortexDream();
            } else if (currentDream === 3) {
                drawFractalDream();
            }
        }

        function drawFallingDream() {
            background(10, 5, 30);
            
            // Stars
            for (let i = 0; i < 100; i++) {
                let x = (noise(i * 0.1, time * 0.1) * width * 2) % width;
                let y = (i * 157) % height;
                fill(255, 255, 255, random(100, 255));
                noStroke();
                ellipse(x, y, 2);
            }
            
            for (let obj of fallingObjects) {
                obj.update();
                obj.display();
            }
        }

        function drawKaleidoscopeDream() {
            background(0);
            translate(width/2, height/2);
            
            for (let i = 0; i < kaleidoSegments; i++) {
                push();
                rotate(TWO_PI / kaleidoSegments * i);
                
                // Mirror effect
                scale(1, 1);
                drawKaleidoSegment();
                
                scale(1, -1);
                drawKaleidoSegment();
                
                pop();
            }
        }

        function drawKaleidoSegment() {
            let spacing = 30;
            for (let r = 0; r < 300; r += spacing) {
                let angle = time + r * 0.01;
                let x = cos(angle) * r;
                let y = sin(angle) * r;
                
                colorMode(HSB);
                fill((time * 50 + r) % 360, 70, 90, 150);
                noStroke();
                ellipse(x, y, spacing - r * 0.05);
                colorMode(RGB);
            }
        }

        function drawVortexDream() {
            background(0, 0, 0, 30);
            
            for (let particle of vortexParticles) {
                particle.update();
                particle.display();
            }
            
            // Center glow
            push();
            blendMode(ADD);
            noStroke();
            for (let i = 5; i > 0; i--) {
                fill(100, 50, 200, 20);
                ellipse(width/2, height/2, i * 100);
            }
            pop();
        }

        function drawFractalDream() {
            background(5, 0, 20);
            
            push();
            translate(width/2, height);
            
            let branches = 5;
            let baseAngle = -PI/2;
            
            for (let i = 0; i < branches; i++) {
                let angle = baseAngle + map(i, 0, branches-1, -PI/4, PI/4);
                let wobble = sin(time * 2 + i) * 0.1;
                drawFractalTree(0, 0, 120, angle + wobble, 10);
            }
            pop();
            
            // Floating particles
            for (let i = 0; i < 50; i++) {
                let x = noise(i * 0.1, time * 0.5) * width;
                let y = noise(i * 0.1 + 100, time * 0.5) * height;
                colorMode(HSB);
                fill((time * 100 + i * 10) % 360, 60, 90, 150);
                noStroke();
                ellipse(x, y, 5);
                colorMode(RGB);
            }
        }

        function mousePressed() {
            if (currentDream === 0) {
                fallingObjects.push(new FallingObject());
                playSound(random(200, 600), 0.3, 'sine');
            } else if (currentDream === 1) {
                kaleidoSegments = (kaleidoSegments % 20) + 4;
                playSound(440, 0.2, 'triangle');
            } else if (currentDream === 2) {
                for (let i = 0; i < 10; i++) {
                    vortexParticles.push(new VortexParticle());
                }
                playSound(330, 0.4, 'sawtooth');
            } else if (currentDream === 3) {
                playSound(660, 0.3, 'square');
            }
        }

        function switchDream(dreamIndex) {
            if (dreamIndex === currentDream) return;
            
            currentDream = dreamIndex;
            
            const titles = ['FALLING', 'KALEIDOSCOPE', 'VORTEX', 'FRACTAL'];
            document.getElementById('dream-title').textContent = titles[dreamIndex];
            
            document.querySelectorAll('.dream-btn').forEach((btn, idx) => {
                btn.classList.toggle('active', idx === dreamIndex);
            });
            
            playSound(220 + dreamIndex * 110, 0.5, 'sawtooth');
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }

        document.querySelectorAll('.dream-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                switchDream(parseInt(btn.dataset.dream));
            });
        });
    </script>
</body>
</html>